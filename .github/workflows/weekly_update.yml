name: Weekly Benchmark Update

on:
  schedule:
    # Run every Sunday at 00:00 UTC
    - cron: '0 0 * * 0'
  workflow_dispatch:

jobs:
  rerun-benchmarks:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        model:
          - qwen2-0.5b
          - qwen2.5-1.5b
          - phi-3-mini
          - tinyllama-1.1b
          - gemma-2b
      max-parallel: 2
      fail-fast: false
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Trigger Benchmark
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'benchmark.yml',
              ref: 'main',
              inputs: {
                model_config: `models/${{ matrix.model }}.yaml`
              }
            });